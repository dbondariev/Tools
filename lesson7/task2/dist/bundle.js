(()=>{"use strict";const t="https://62cde2d7066bd2b6992da5e6.mockapi.io/api/v1/tasks",e=()=>fetch(t).then((t=>t.json())),n=(t,e)=>t.done-e.done||new Date(t.createDate)-new Date(e.createDate),s=t=>{let{text:e,done:n,id:s}=t;const c=document.createElement("li");c.classList.add("list-item","list__item");const a=(t=>{let{done:e}=t;const n=document.createElement("input");return n.setAttribute("type","checkbox"),n.checked=e,n.classList.add("list-item__checkbox"),n})({done:n});n&&c.classList.add("list-item_done");const i=document.createElement("span");i.classList.add("list-item__text"),i.textContent=e;const o=document.createElement("button");return o.classList.add("list-item__delete-btn"),c.dataset.id=s,c.append(a,i,o),c},c=()=>{e().then((t=>{const e=t,c=document.querySelector(".list");c.innerHTML="";const a=e.sort(n).map(s);c.append(...a)}))},a=()=>{const n=document.querySelector(".task-input"),s=n.value;if(!s)return;n.value="";var a;(a={text:s,done:!1,createDate:(new Date).toISOString(),id:Math.trunc(1e3*Math.random()).toString()},fetch(t,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(a)})).then((()=>e())).then((t=>{c()}))},i=n=>{const s=n.target.classList.contains("list-item__checkbox"),a=n.target.classList.contains("list-item__delete-btn");if(!s&&!a)return;const i=n.target.closest(".list-item").dataset.id;s&&e().then((s=>{const a=s,{text:o,createDate:d}=a.find((t=>t.id===i)),r=n.target.checked,l={text:o,createDate:d,done:r,finishDate:r?(new Date).toISOString():null};((e,n)=>fetch(`${t}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}))(i,l).then((()=>e())).then((()=>{c()}))})),a&&(e=>fetch(`${t}/${e}`,{method:"DELETE"}))(i).then((()=>e())).then((()=>{c()}))};document.addEventListener("DOMContentLoaded",(()=>{c(),document.querySelector(".create-task-btn").addEventListener("click",a),document.querySelector(".todo-list").addEventListener("click",i)}))})();